{% extends "base.html" %}

{% block title %}Teacher Dashboard - LearnLoop{% endblock %}

{% block content %}
<style>
    body {
        background-color: #E8E9E8 !important;
    }
</style>
<div class="sticky top-0 z-50 bg-[#E8E9E8] border-b border-slate-200 dark:border-slate-800">
    <div class="flex items-center p-4 pb-4 justify-between max-w-md mx-auto">
        <h2 class="text-xl font-bold leading-tight tracking-tight flex-1">{{ current_user.username }}</h2>
    </div>
</div>
<main class="max-w-md mx-auto pb-32">
    <div class="flex flex-wrap gap-3 p-4">
        <div class="flex min-w-[140px] flex-1 flex-col gap-1 rounded-xl p-4 bg-black shadow-sm border border-black">
            <div class="flex items-center gap-2 text-white">
                <span class="material-symbols-outlined text-sm">group</span>
                <p class="text-xs font-semibold uppercase tracking-wider opacity-80 text-gray-400">Total Students</p>
            </div>
            <p class="text-2xl font-bold leading-tight mt-1 text-white">{{ total_students }}</p>
        </div>
        <div class="flex min-w-[140px] flex-1 flex-col gap-1 rounded-xl p-4 bg-black shadow-sm border border-black">
            <div class="flex items-center gap-2 text-emerald-400">
                <span class="material-symbols-outlined text-sm">trending_up</span>
                <p class="text-xs font-semibold uppercase tracking-wider opacity-80 text-gray-400">Avg. Mastery</p>
            </div>
            <p class="text-2xl font-bold leading-tight mt-1 text-white">{{ avg_mastery }}%</p>
        </div>
    </div>

    <div class="px-4 mt-6 mb-2">
        <a href="{{ url_for('classes.create') }}"
            class="flex w-full items-center justify-center gap-2 rounded-xl h-12 bg-primary text-white text-base font-bold shadow-lg shadow-primary/25 hover:bg-blue-600 transition-all active:scale-[0.98]">
            <span class="material-symbols-outlined">add_circle</span>
            <span>Create New Class</span>
        </a>
    </div>
    <div class="flex items-center justify-between px-4 mt-6">
        <h3 class="text-lg font-bold">Active Classes</h3>
        <span class="text-xs font-medium text-primary px-2 py-1 bg-primary/10 rounded-full">{{ classes|length }}
            Classes</span>
    </div>
    <div class="mt-2 space-y-1">
        {% for class in classes %}
        <div
            class="flex items-center gap-4 bg-black text-white hover:bg-gray-900 px-4 min-h-[80px] py-3 cursor-pointer transition-colors mx-4 rounded-xl border border-transparent mb-3">
            <div class="flex items-center gap-4 flex-1">
                <!-- Rotate colors based on index/id -->
                {% set colors = ['bg-primary', 'bg-purple-500', 'bg-orange-500', 'bg-indigo-500', 'bg-pink-500',
                'bg-teal-500'] %}
                {% set color = colors[loop.index0 % colors|length] %}
                <div
                    class="text-white flex items-center justify-center rounded-xl {{ color }} shrink-0 size-12 shadow-lg shadow-primary/20">
                    <!-- Icon logic could be improved, but randomizing for now -->
                    {% set icons = ['history_edu', 'biotech', 'calculate', 'language', 'public', 'psychology'] %}
                    <span class="material-symbols-outlined">{{ icons[loop.index0 % icons|length] }}</span>
                </div>
                <div class="flex flex-col justify-center">
                    <p class="font-bold leading-tight">{{ class.name }}</p>
                    <p class="text-gray-300 text-sm font-normal mt-0.5">
                        {{ class.members.count() }} Students â€¢ Invite: {{ class.invite_code }}
                    </p>
                </div>
            </div>
            <div class="shrink-0 flex items-center gap-2">
                <!-- Status dot (mocked logic) -->
                {% if class.members.count() > 0 %}
                <div class="w-1.5 h-1.5 rounded-full bg-emerald-500"></div>
                {% else %}
                <div class="w-1.5 h-1.5 rounded-full bg-slate-300"></div>
                {% endif %}
                <span class="material-symbols-outlined text-slate-400">chevron_right</span>
            </div>
        </div>
        {% else %}
        <div class="p-4 text-center text-slate-500">
            No classes found. Create your first class!
        </div>
        {% endfor %}
    </div>

</main>

<nav class="fixed bottom-0 left-0 right-0 bg-[#E8E9E8] border-t border-black/5 pb-8 pt-3 px-6 z-50">
    <div class="max-w-md mx-auto flex justify-between items-center">
        <div class="flex flex-col items-center gap-1 text-gray-500 hover:text-black">
            <span class="material-symbols-outlined">home</span>
            <span class="text-[10px] font-medium">Home</span>
        </div>
        <div class="flex flex-col items-center gap-1 text-gray-500 hover:text-black">
            <span class="material-symbols-outlined">layers</span>
            <span class="text-[10px] font-medium">Decks</span>
        </div>
        <div class="flex flex-col items-center gap-1 text-gray-500 hover:text-black">
            <span class="material-symbols-outlined">school</span>
            <span class="text-[10px] font-medium">Study</span>
        </div>
        <a class="flex flex-col items-center gap-1 text-gray-500 hover:text-black" href="{{ url_for('main.stats') }}">
            <span class="material-symbols-outlined">leaderboard</span>
            <span class="text-[10px] font-medium">Stats</span>
        </a>
        <div class="flex flex-col items-center gap-1 text-black active-tab">
            <span class="material-symbols-outlined">group</span>
            <span class="text-[10px] font-bold">Classes</span>
        </div>
        <a class="flex flex-col items-center gap-1 text-gray-500 hover:text-black" href="{{ url_for('auth.logout') }}">
            <span class="material-symbols-outlined">logout</span>
            <span class="text-[10px] font-medium">Log out</span>
        </a>
    </div>
</nav>
{% endblock %}